<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>TEG - The Office</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #222;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }

      .hotspot {
        position: absolute;
        width: 80px;
        height: 80px;
        cursor: pointer;
        z-index: 2;
      }

      #gamePanel {
        position: fixed;
        z-index: 1;
        top: 0;
        aspect-ratio: 4 / 3;
        width: auto;
        height: 100vh;
        overflow: hidden;
        left: 0;
        display: flex;
        justify-content: center;
      }

      .popupIcon {
        height: 20%;
        width: 20%;
      }

      .fullImg {
        height: 100%;
        width: 100%;
      }

      .popupText {
        width: 80%;
        float: right;
        padding-bottom: 5%;
      }

      .popup {
        display: none;
        position: absolute;
        top: 30%;
        left: 32.5%;
        padding: 5px 7px;
        background: #ffe7e2;
        color: black;
        border-radius: 2.5em;
        z-index: 100;
        font-size: 1em;
        width: 40%;
      }

      .close-btn {
        position: absolute;
        padding: 5px 7px;
        right: 5%;
        bottom: 5%;
        background-color: #b96958;
        color: #fff;
        border-radius: 2.5em;
        border: none;
        cursor: pointer;
        font-size: 1em;
      }

      .clueText {
        text-align: center;
        padding-bottom: 0;
        color: #b96958;
      }

      .leftBtn {
        position: absolute;
        z-index: 300;
        top: 0;
        left: 0;
        height: 100vh;
        padding: 42.5% 2.5%;
        font-size: 2.5em;
        border: none;
        background: #555;
        opacity: 0.25;
        color: #fff;
        cursor: pointer;
        font-weight: 600;
        text-decoration: none;
      }

      .rightBtn {
        position: absolute;
        z-index: 500;
        top: 0;
        right: 0;
        height: 100vh;
        padding: 42.5% 2.5%;
        font-size: 2.5em;
        border: none;
        background: #555;
        opacity: 0.25;
        color: #fff;
        cursor: pointer;
        font-weight: 600;
        text-decoration: none;
      }

      #phone {
        top: 41%;
        left: 37%;
        width: 7%;
        height: 19%;
      }
      #depths {
        top: 34%;
        left: 61.5%;
        width: 7%;
        height: 13%;
      }
      #timeliner {
        top: 26%;
        left: 81%;
        width: 10.5%;
        height: 21%;
      }
      #playground {
        top: 50%;
        left: 52%;
        width: 15%;
        height: 17%;
      }
      #goldrush {
        top: 58%;
        left: 72%;
        width: 7.5%;
        height: 9%;
      }
      #colts {
        top: 70%;
        left: 51%;
        width: 9.5%;
        height: 19%;
      }
      #ducks {
        top: 83%;
        left: 79%;
        width: 13.5%;
        height: 7%;
      }
      .key {
        height: 100%;
        width: 100%;
        margin: 1.5%;
        background-color: white;
        border: none;
        font-size: 0.8em;
      }
    </style>
  </head>
  <body>
    <div id="gamePanel">
      <a class="leftBtn" href="../walls/gallery.html">&lt;</a>
      <img
        src="../../assets/images/walls/bookshelf_bg.jpg"
        alt="Desk"
        class="desk-img"
      />

      <!-- Hotspots -->
      <div class="hotspot" id="phone" onclick="openPopup('phonePopup')"></div>
      <div class="hotspot" id="depths" onclick="openPopup('depthsPopup')"></div>
      <div
        class="hotspot"
        id="timeliner"
        onclick="openPopup('timelinerPopup')"
      ></div>
      <div
        class="hotspot"
        id="playground"
        onclick="openPopup('playgroundPopup')"
      ></div>
      <div
        class="hotspot"
        id="goldrush"
        onclick="openPopup('goldrushPopup')"
      ></div>
      <div class="hotspot" id="colts" onclick="openPopup('coltsPopup')"></div>
      <div class="hotspot" id="ducks" onclick="openPopup('ducksPopup')"></div>

      <a class="rightBtn" href="../walls/crafts.html">&gt;</a>
    </div>

    <div id="phonePopup" class="popup">
      <div style="text-align: center">
        <h3>Phone</h3>
        <div
          id="phoneDisplay"
          style="
            background: #fff;
            color: #000;
            font-size: 1.5em;
            padding: 7px;
            margin-bottom: 5px;
            letter-spacing: 2px;
            height: 1.8em;
          "
        ></div>

        <div
          id="keypad"
          style="
            display: grid;
            grid-template-columns: repeat(3, 31.5%);
            grid-gap: 10px;
            justify-content: left;
            margin-bottom: 15px;
          "
        >
          <button class="key">1</button>
          <button class="key">2</button>
          <button class="key">3</button>
          <button class="key">4</button>
          <button class="key">5</button>
          <button class="key">6</button>
          <button class="key">7</button>
          <button class="key">8</button>
          <button class="key">9</button>
          <button class="key">*</button>
          <button class="key">0</button>
          <button class="key">#</button>
        </div>

        <button
          id="callBtn"
          style="
            background: #b96958;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5em;
            cursor: pointer;
          "
        >
          Dial
        </button>

        <div
          id="callScreen"
          style="margin-top: 15px; min-height: 150px; color: black"
        ></div>
      </div>

      <button class="close-btn" onclick="closePopup()">Close</button>
    </div>

    <div id="depthsPopup" class="popup">
      <image
        class="popupIcon"
        src="../../assets/images/bookshelf/Depths.png"
      ></image>
      <div class="popupText">
        <h3>The Depths ðŸ’›</h3>
        <p>
          Found the baby kraken with 20 minutes to spare, and 24% of my ship
          still functional! An absolute thrill.
          <br />
          <br />
          All the knot tying I learned in Girl Scouts really paid off.
        </p>
      </div>
      <button class="close-btn" onclick="closePopup()">Close</button>
    </div>

    <div id="timelinerPopup" class="popup">
      <image
        class="popupIcon"
        src="../../assets/images/bookshelf/Timeliner.png"
      ></image>
      <div class="popupText">
        <h3>Timeliner: Train Through Time ðŸ’›</h3>
        <p>
          Loved the alliteration of this title. Loved the room as well, just
          wished I could've stayed with the dinosaurs longer!
          <br />
          <br />
          Saved the multiverse in just under 10 minutes.
        </p>
      </div>
      <button class="close-btn" onclick="closePopup()">Close</button>
    </div>

    <div id="playgroundPopup" class="popup">
      <image
        class="popupIcon"
        src="../../assets/images/bookshelf/Playground.png"
      ></image>
      <div class="popupText">
        <h3>Playground ðŸ’›</h3>
        <p>
          11 seconds. I get that this was supposed to be an easier room, but I
          realized that I can't find birds to save my life (or graduate 4th
          grade).
          <br />
          <br />
          I might need to try this one again with more than just one other
          person.
        </p>
      </div>
      <button class="close-btn" onclick="closePopup()">Close</button>
    </div>

    <div id="goldrushPopup" class="popup">
      <image
        class="popupIcon"
        src="../../assets/images/bookshelf/goldrush.png"
      ></image>
      <div class="popupText">
        <h3>Gold Rush ðŸ’›</h3>
        <p>
          With 15 minutes to spare, I was able to find Clyde's fortune. Quite
          possibly my favorite room.
          <br />
          <br />
          It took me back in time to Boiler Gold Rush, the freshman orientation
          week at Purdue.
        </p>
      </div>
      <button class="close-btn" onclick="closePopup()">Close</button>
    </div>

    <div id="coltsPopup" class="popup">
      <image
        class="popupIcon"
        src="../../assets/images/bookshelf/Colts.png"
      ></image>
      <div class="popupText">
        <h3>Indianapolis Colts ðŸ’›</h3>
        <p>
          After moving to Indiana in 2017, I figured it was about time to pick a
          favorite NFL team...
          <br />
          <br />
          Unfortunately, I moved to Indiana about a decade too late to see the
          Colts in their prime.
        </p>
      </div>
      <button class="close-btn" onclick="closePopup()">Close</button>
    </div>

    <div id="ducksPopup" class="popup">
      <image
        class="popupIcon"
        src="../../assets/images/bookshelf/Duckies.png"
      ></image>
      <div class="popupText">
        <h3>Got any grapes? ðŸ’›</h3>
        <p>
          A duck walked up to a lemonade stand, and he said to the woman... can
          I join your collection?
          <br />
          <br />
          Rhyming might not be my strong suit, but about 30 ducks live on my
          bookshelf. When I graduated, my grandmother gave me a pirate duck as a
          way for me to engage in 'Rubber Duck Debugging'. Little did I know
          what a collection that would start.
        </p>
      </div>
      <button class="close-btn" onclick="closePopup()">Close</button>
    </div>

    <script>
      document.addEventListener("keydown", (event) => {
        const validKeys = [
          "0",
          "1",
          "2",
          "3",
          "4",
          "5",
          "6",
          "7",
          "8",
          "9",
          "*",
          "#",
        ];

        if (validKeys.includes(event.key)) {
          dialedNumber += event.key;
          phoneDisplay.textContent = dialedNumber;
        } else if (event.key === "Backspace") {
          dialedNumber = dialedNumber.slice(0, -1);
          phoneDisplay.textContent = dialedNumber;
        } else if (event.key === "Enter") {
          // ðŸ”‘ Simulate pressing the call button
          callBtn.click();
        }
      });

      function openPopup(id) {
        // Close any open popups
        document
          .querySelectorAll(".popup")
          .forEach((p) => (p.style.display = "none"));
        // Show the chosen popup
        document.getElementById(id).style.display = "block";
      }

      function closePopup() {
        document
          .querySelectorAll(".popup")
          .forEach((p) => (p.style.display = "none"));
      }

      // Optional: click outside to close
      document.addEventListener("click", (e) => {
        if (
          !e.target.classList.contains("hotspot") &&
          !e.target.closest(".popup")
        ) {
          closePopup();
        }
      });

      // --- Elements ---
      const phoneDisplay = document.getElementById("phoneDisplay");
      const callScreen = document.getElementById("callScreen");
      const callBtn = document.getElementById("callBtn");
      const keypadButtons = document.querySelectorAll("#keypad .key");

      let dialedNumber = "";

      // --- Add number on keypad press ---
      keypadButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          dialedNumber += btn.textContent;
          phoneDisplay.textContent = dialedNumber;
        });
      });

      // --- Check if desk tasks are done ---
      function allTasksCompleted() {
        return (
          sessionStorage.getItem("unlocked") === "true" &&
          sessionStorage.getItem("unlockFolder") === "true"
        );
      }

      // --- Dial button logic ---
      callBtn.addEventListener("click", () => {
        // Debugging
        console.log("Dialed number:", dialedNumber);
        console.log("Unlocked:", sessionStorage.getItem("unlocked"));
        console.log("Folder unlocked:", sessionStorage.getItem("unlockFolder"));

        if (dialedNumber === "3179090503") {
          if (allTasksCompleted()) {
            window.location.href = "../../html/endScreen.html";
          } else {
            callScreen.innerHTML = `<p style="color:red;">The number you are trying to reach is unavailable. <br/> Please finish all tasks.</p>`;
            dialedNumber = "";
            phoneDisplay.textContent = "";
          }
        } else {
          callScreen.innerHTML = `<p style="color:gray;">Number not recognized.</p>`;
          dialedNumber = "";
          phoneDisplay.textContent = "";
        }
      });
    </script>
  </body>
</html>
